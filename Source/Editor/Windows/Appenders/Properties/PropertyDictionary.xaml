<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:Properties="clr-namespace:Editor.Windows.Appenders.Properties"
                    xmlns:Models="clr-namespace:Editor.Models"
                    xmlns:Converters="clr-namespace:Editor.Converters"
                    xmlns:Editor="clr-namespace:Editor">
    
    <Converters:BoolInterverConverter x:Key="BoolInvConv" />

    <Style TargetType="Label">
        <Setter Property="FontWeight" Value="Bold" />
        <Setter Property="HorizontalAlignment" Value="Right" />
    </Style>
    <Style TargetType="TextBox">
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Height" Value="21" />
        <Setter Property="Margin" Value="0,0,5,0" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding IsFocused}" Value="True">
                <Setter Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Self}}" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <DataTemplate DataType="{x:Type Properties:StringValueProperty}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label Content="{Binding Name}"/>
            <TextBox Grid.Column="1" Text="{Binding Value}" ToolTip="{Binding ToolTip}"/>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:Target}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>Target:</Label>
            <ComboBox ItemsSource="{Binding Targets}" 
                      SelectedItem="{Binding SelectedItem}" 
                      Grid.Column="1" 
                      Width="100" 
                      VerticalAlignment="Center" 
                      HorizontalAlignment="Left" />
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:File}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>File:</Label>
            <StackPanel Grid.Column="1">
                <DockPanel>
                    <Button DockPanel.Dock="Right" Width="50" Height="21" Margin="0,5,5,5" Command="{Binding Open}">Open</Button>
                    <TextBox Text="{Binding FilePath}" />                    
                </DockPanel>
                <StackPanel Orientation="Horizontal">
                    <RadioButton IsChecked="{Binding Overwrite, Converter={StaticResource BoolInvConv}}">Append</RadioButton>
                    <RadioButton IsChecked="{Binding Overwrite}" Margin="5,0">Overwrite</RadioButton>
                </StackPanel>
            </StackPanel>
        </Grid>
    </DataTemplate>
    
    <DataTemplate DataType="{x:Type Properties:StaticLogFileName}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
        
            <Label>Static Log File Name:</Label>
            <CheckBox Grid.Column="1" IsChecked="{Binding Value}" VerticalAlignment="Center"/>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:PreserveExtension}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>Preserve Extension:</Label>
            <CheckBox Grid.Column="1" IsChecked="{Binding Preserve}" VerticalAlignment="Center"/>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:CountDirection}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
        
            <Label>Count Direction:</Label>
            <ComboBox Grid.Column="1" 
                      ItemsSource="{Binding Directions}" 
                      SelectedItem="{Binding SelectedDirection}" 
                      HorizontalAlignment="Left" 
                      VerticalAlignment="Center"
                      Width="75"
                      ToolTip="Indicates if the current file is the lowest numbered file or the highest numbered file."/>
        </Grid>
    </DataTemplate>
    
    <DataTemplate DataType="{x:Type Properties:LockingModel}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <Label>Locking Model:</Label>
            <StackPanel Grid.Column="1">
                <ComboBox ItemsSource="{Binding LockingModels}" 
                          SelectedItem="{Binding SelectedModel}" 
                          HorizontalAlignment="Left" 
                          VerticalAlignment="Center"
                          Width="100" 
                          Margin="0,5,0,0">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <Label Padding="0" Content="{Binding Name}" FontWeight="Normal"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <TextBlock FontStyle="Italic" Foreground="Gray">See 
                    <Hyperlink x:Name="xLockingModelHyperlink" 
                               NavigateUri="https://logging.apache.org/log4net/release/sdk/html/P_log4net_Appender_FileAppender_LockingModel.htm" 
                               Command="{Binding Navigate}" 
                               CommandParameter="{Binding ElementName=xLockingModelHyperlink, Path=NavigateUri}">
                        Locking Model
                    </Hyperlink> for more information.
                </TextBlock>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:RollingStyle}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>Rolling Style:</Label>
            <StackPanel Grid.Column="1">
                <ComboBox ItemsSource="{Binding Modes}" 
                          SelectedItem="{Binding SelectedMode}" 
                          HorizontalAlignment="Left" 
                          VerticalAlignment="Center"
                          Width="85"
                          Margin="0,5,0,5"/>
                <TextBlock FontStyle="Italic" Foreground="Gray">See 
                    <Hyperlink x:Name="xRollingStyleHyperlink" 
                               NavigateUri="https://logging.apache.org/log4net/release/sdk/html/P_log4net_Appender_RollingFileAppender_RollingStyle.htm" 
                               Command="{Binding Navigate}" 
                               CommandParameter="{Binding ElementName=xRollingStyleHyperlink, Path=NavigateUri}">
                        Rolling Style
                        </Hyperlink> and 
                    <Hyperlink x:Name="xRollingModeHyperlink" 
                               NavigateUri="https://logging.apache.org/log4net/release/sdk/html/T_log4net_Appender_RollingFileAppender_RollingMode.htm" 
                               Command="{Binding Navigate}" 
                               CommandParameter="{Binding ElementName=xRollingModeHyperlink, Path=NavigateUri}">
                        Rolling Mode
                    </Hyperlink> for more information.
                </TextBlock>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:Fix}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>Fix:</Label>
            <StackPanel Grid.Column="1">
                <ComboBox ItemsSource="{Binding Fixes}" SelectedItem="{Binding SelectedFix}" Width="100" Height="21" HorizontalAlignment="Left">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <Label Padding="0" Content="{Binding}" FontWeight="Normal"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <TextBlock FontStyle="Italic" Foreground="Gray">  
                    See 
                    <Hyperlink x:Name="xQuestionHyperlink" 
                               NavigateUri="https://stackoverflow.com/q/11319319/7355697" 
                               Command="{Binding Navigate}" 
                               CommandParameter="{Binding ElementName=xQuestionHyperlink, Path=NavigateUri}">
                        this issue
                    </Hyperlink> and 
                    <Hyperlink x:Name="xFixHyperlink" 
                               NavigateUri="https://logging.apache.org/log4net/release/sdk/html/P_log4net_Core_LoggingEvent_Fix.htm" 
                               Command="{Binding Navigate}"
                               CommandParameter="{Binding ElementName=xFixHyperlink, Path=NavigateUri}">
                        these docs
                    </Hyperlink> for more information.
                </TextBlock>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:Layout}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>Layout:</Label>
            <StackPanel Grid.Column="1">
                <StackPanel.Resources>
                    <Converters:LayoutToEnabledConverter x:Key="Ltec" />
                </StackPanel.Resources>
                <ComboBox Width="75" Height="21" Margin="0,5" HorizontalAlignment="Left"
                          ItemsSource="{Binding Layouts}" SelectedItem="{Binding SelectedLayout}" >
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <Label Padding="0" Content="{Binding Name}" FontWeight="Normal"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <TextBox Text="{Binding Pattern}" FontFamily="Consolas" VerticalContentAlignment="Center" ToolTip="Enter pattern here" IsEnabled="{Binding SelectedLayout, Converter={StaticResource Ltec}}" />
                <TextBlock FontStyle="Italic" Foreground="Gray">  
                    See 
                    <Hyperlink x:Name="xLayoutHyperlink" 
                               NavigateUri="https://logging.apache.org/log4net/release/sdk/html/T_log4net_Layout_PatternLayout.htm" 
                               Command="{Binding Navigate}" 
                               CommandParameter="{Binding ElementName=xLayoutHyperlink, Path=NavigateUri}">
                        Pattern Layout
                    </Hyperlink> for more information.
                </TextBlock>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:Filters}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>Filters:</Label>
            <DockPanel Grid.Column="1" Margin="0,5,0,0">
                <StackPanel DockPanel.Dock="Right">
                    <StackPanel.Resources>
                        <!--Override the Label style defined above so that drop down button uses the default style-->
                        <Style TargetType="Label" />
                        <Style TargetType="Button">
                            <Setter Property="Width" Value="85" />
                            <Setter Property="Margin" Value="5,0,5,5" />
                        </Style>
                    </StackPanel.Resources>
                    <Editor:DropDownButton ButtonName="Add" ItemsSource="{Binding AvailableFilters}" Command="{Binding AddFilter}"/>
                    <Button Command="{Binding Help}">Help</Button>
                </StackPanel>
                <DataGrid ItemsSource="{Binding ExistingFilters}" AutoGenerateColumns="false" IsReadOnly="True" CanUserSortColumns="False">
                    <DataGrid.Resources>
                        <Converters:FilterTypeToBoolConverter x:Key="Fttbc"/>
                    </DataGrid.Resources>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Type" Binding="{Binding Descriptor.Name}"/>
                        <DataGridTemplateColumn Header="Options">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate DataType="{x:Type Models:FilterModel}">
                                    <StackPanel Orientation="Horizontal">
                                        <Button Width="50" Margin="5,5,0,5" Command="{Binding Edit}" IsEnabled="{Binding Descriptor.Type, Converter={StaticResource Fttbc}}">Edit</Button>
                                        <Button Width="50" Margin="5,5,0,5" Command="{Binding Remove}">Remove</Button>
                                        <Button Width="25" Margin="5,5,0,5" Command="{Binding MoveUp}">↑</Button>
                                        <Button Width="25" Margin="5,5,0,5" Command="{Binding MoveDown}">↓</Button>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type Properties:Refs}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="FirstColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label>Refs:</Label>
            <DockPanel Grid.Column="1">
                <Label FontWeight="Normal" HorizontalAlignment="Left" DockPanel.Dock="Top" Padding="0" Margin="0,5,0,0">This appender can be referenced in the following loggers:</Label>
                <ListBox x:Name="xRefsListBox" Margin="0,5,5,0" ItemsSource="{Binding RefsCollection}">
                    <ListBox.ItemTemplate>
                        <DataTemplate DataType="Models:LoggerModel">
                            <CheckBox Content="{Binding Name}" IsChecked="{Binding IsEnabled}"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </DockPanel>
        </Grid>
    </DataTemplate>
</ResourceDictionary>